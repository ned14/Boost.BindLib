<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QuickCppLib: quickcpplib::_xxx::configurable_spinlock::shared_spinlock&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QuickCppLib<span id="projectnumber">&#160;0.10</span>
   </div>
   <div id="projectbrief">Eliminate all the tedious hassle when making state-of-the-art C++ 14 - 23 libraries!</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">quickcpplib::_xxx::configurable_spinlock::shared_spinlock&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A non-FIFO policy configurable shared/exclusive spin lock meeting the <code>SharedMutex</code> concept.  
 <a href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html#details">More...</a></p>

<p><code>#include &quot;spinlock.hpp&quot;</code></p>
<div class="dynheader">
Inheritance diagram for quickcpplib::_xxx::configurable_spinlock::shared_spinlock&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac46cb92d3a8fa918929de909dd41d8ab" id="r_ac46cb92d3a8fa918929de909dd41d8ab"><td class="memItemLeft" align="right" valign="top">constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html#ac46cb92d3a8fa918929de909dd41d8ab">shared_spinlock</a> ()</td></tr>
<tr class="separator:ac46cb92d3a8fa918929de909dd41d8ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ee6be828c27fd80a9d9e7862ecd7b57" id="r_a8ee6be828c27fd80a9d9e7862ecd7b57"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html#a8ee6be828c27fd80a9d9e7862ecd7b57">shared_spinlock</a> (const <a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">shared_spinlock</a> &amp;)=delete</td></tr>
<tr class="separator:a8ee6be828c27fd80a9d9e7862ecd7b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa25d4abe1ded72424d5e9980465904" id="r_aaaa25d4abe1ded72424d5e9980465904"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html#aaaa25d4abe1ded72424d5e9980465904">shared_spinlock</a> (<a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">shared_spinlock</a> &amp;&amp;o) noexcept</td></tr>
<tr class="separator:aaaa25d4abe1ded72424d5e9980465904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f934bbcaad362f15f4a009602cb708" id="r_a77f934bbcaad362f15f4a009602cb708"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html#a77f934bbcaad362f15f4a009602cb708">lock</a> () noexcept</td></tr>
<tr class="memdesc:a77f934bbcaad362f15f4a009602cb708"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locks the spinlock for exclusive access.  <br /></td></tr>
<tr class="separator:a77f934bbcaad362f15f4a009602cb708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be86d2deee48329b0f36470e77a5d78" id="r_a2be86d2deee48329b0f36470e77a5d78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html#a2be86d2deee48329b0f36470e77a5d78">lock_shared</a> () noexcept</td></tr>
<tr class="memdesc:a2be86d2deee48329b0f36470e77a5d78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locks the spinlock for shared access.  <br /></td></tr>
<tr class="separator:a2be86d2deee48329b0f36470e77a5d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T = uintptr_t, template&lt; class &gt; class spinpolicy2 = spins_to_loop&lt;125&gt;::policy, template&lt; class &gt; class spinpolicy3 = spins_to_yield&lt;250&gt;::policy, template&lt; class &gt; class spinpolicy4 = spins_to_sleep::policy&gt;<br />
class quickcpplib::_xxx::configurable_spinlock::shared_spinlock&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt;</div><p>A non-FIFO policy configurable shared/exclusive spin lock meeting the <code>SharedMutex</code> concept. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>An unsigned integral type capable of atomic usage</td></tr>
  </table>
  </dd>
</dl>
<p><code>sizeof(shared_spinlock&lt;T&gt;) == sizeof(T)</code>. Suitable for usage in shared memory.</p>
<p>Implementing a fair shared spin lock with acceptable performance in just four bytes of storage is challenging, so this is a reader-biased shared lock which uses bit 0 as the exclusion bit, and the remainder of the bits to track how many readers are in the shared lock. Undefined behaviour will occur if the number of concurrent readers exceeds half the maximum value of a <code>T</code>.</p>
<p>Maximum performance on Intel for exclusive locks is the same as a <code>spinlock&lt;uintptr_t&gt;</code>. For shared locks it is roughly one third that of <code>spinlock&lt;uintptr_t&gt;</code> due to performing twice as many atomic read-modify-updates. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac46cb92d3a8fa918929de909dd41d8ab" name="ac46cb92d3a8fa918929de909dd41d8ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46cb92d3a8fa918929de909dd41d8ab">&#9670;&#160;</a></span>shared_spinlock() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = uintptr_t, template&lt; class &gt; class spinpolicy2 = spins_to_loop&lt;125&gt;::policy, template&lt; class &gt; class spinpolicy3 = spins_to_yield&lt;250&gt;::policy, template&lt; class &gt; class spinpolicy4 = spins_to_sleep::policy&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">quickcpplib::_xxx::configurable_spinlock::shared_spinlock</a>&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt;::shared_spinlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  792</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ee6be828c27fd80a9d9e7862ecd7b57" name="a8ee6be828c27fd80a9d9e7862ecd7b57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ee6be828c27fd80a9d9e7862ecd7b57">&#9670;&#160;</a></span>shared_spinlock() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = uintptr_t, template&lt; class &gt; class spinpolicy2 = spins_to_loop&lt;125&gt;::policy, template&lt; class &gt; class spinpolicy3 = spins_to_yield&lt;250&gt;::policy, template&lt; class &gt; class spinpolicy4 = spins_to_sleep::policy&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">quickcpplib::_xxx::configurable_spinlock::shared_spinlock</a>&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt;::shared_spinlock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">shared_spinlock</a>&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt; &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aaaa25d4abe1ded72424d5e9980465904" name="aaaa25d4abe1ded72424d5e9980465904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaa25d4abe1ded72424d5e9980465904">&#9670;&#160;</a></span>shared_spinlock() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = uintptr_t, template&lt; class &gt; class spinpolicy2 = spins_to_loop&lt;125&gt;::policy, template&lt; class &gt; class spinpolicy3 = spins_to_yield&lt;250&gt;::policy, template&lt; class &gt; class spinpolicy4 = spins_to_sleep::policy&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">quickcpplib::_xxx::configurable_spinlock::shared_spinlock</a>&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt;::shared_spinlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">shared_spinlock</a>&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  795</span>        : parenttype(std::move(o))</div>
<div class="line"><span class="lineno">  796</span>    {</div>
<div class="line"><span class="lineno">  797</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a77f934bbcaad362f15f4a009602cb708" name="a77f934bbcaad362f15f4a009602cb708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77f934bbcaad362f15f4a009602cb708">&#9670;&#160;</a></span>lock()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = uintptr_t, template&lt; class &gt; class spinpolicy2 = spins_to_loop&lt;125&gt;::policy, template&lt; class &gt; class spinpolicy3 = spins_to_yield&lt;250&gt;::policy, template&lt; class &gt; class spinpolicy4 = spins_to_sleep::policy&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">quickcpplib::_xxx::configurable_spinlock::shared_spinlock</a>&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt;::lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Locks the spinlock for exclusive access. </p>
<div class="fragment"><div class="line"><span class="lineno">  800</span>    {</div>
<div class="line"><span class="lineno">  801</span>      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0;; n++)</div>
<div class="line"><span class="lineno">  802</span>      {</div>
<div class="line"><span class="lineno">  803</span>        <span class="keywordflow">if</span>(parenttype::try_lock())</div>
<div class="line"><span class="lineno">  804</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  805</span>        parenttype::int_yield(n);</div>
<div class="line"><span class="lineno">  806</span>      }</div>
<div class="line"><span class="lineno">  807</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2be86d2deee48329b0f36470e77a5d78" name="a2be86d2deee48329b0f36470e77a5d78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be86d2deee48329b0f36470e77a5d78">&#9670;&#160;</a></span>lock_shared()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T  = uintptr_t, template&lt; class &gt; class spinpolicy2 = spins_to_loop&lt;125&gt;::policy, template&lt; class &gt; class spinpolicy3 = spins_to_yield&lt;250&gt;::policy, template&lt; class &gt; class spinpolicy4 = spins_to_sleep::policy&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">quickcpplib::_xxx::configurable_spinlock::shared_spinlock</a>&lt; T, spinpolicy2, spinpolicy3, spinpolicy4 &gt;::lock_shared </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Locks the spinlock for shared access. </p>
<div class="fragment"><div class="line"><span class="lineno">  810</span>    {</div>
<div class="line"><span class="lineno">  811</span>      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0;; n++)</div>
<div class="line"><span class="lineno">  812</span>      {</div>
<div class="line"><span class="lineno">  813</span>        <span class="keywordflow">if</span>(parenttype::try_lock_shared())</div>
<div class="line"><span class="lineno">  814</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  815</span>        parenttype::int_yield(n);</div>
<div class="line"><span class="lineno">  816</span>      }</div>
<div class="line"><span class="lineno">  817</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/quickcpplib/<a class="el" href="spinlock_8hpp.html">spinlock.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacequickcpplib.html">quickcpplib</a></li><li class="navelem"><a class="el" href="namespacequickcpplib_1_1__xxx.html">_xxx</a></li><li class="navelem"><a class="el" href="namespacequickcpplib_1_1__xxx_1_1configurable__spinlock.html">configurable_spinlock</a></li><li class="navelem"><a class="el" href="classquickcpplib_1_1__xxx_1_1configurable__spinlock_1_1shared__spinlock.html">shared_spinlock</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
